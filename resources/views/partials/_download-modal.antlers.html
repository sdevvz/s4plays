<div id="download-modal" class="fixed inset-0 z-[60] hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    {{# Backdrop #}}
    <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity backdrop-blur-sm"></div>

    <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
        <div class="relative transform overflow-hidden rounded-2xl bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
            
            {{# Header #}}
            <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6 justify-between items-center border-b border-gray-100">
                <button type="button" class="text-gray-400 hover:text-gray-500 focus:outline-none" onclick="closeModal()">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
                <h3 class="text-base font-semibold leading-6 text-gray-900" id="modal-app-title">Processing Request</h3>
            </div>

            {{# Body #}}
            <div class="px-4 py-8 sm:px-10">
                <div class="flex flex-col items-center">
                    
                    {{# Step 1: Connecting #}}
                    <div id="step-1" class="text-center w-full">
                        <div class="loader mx-auto mb-6"></div>
                        <h4 class="text-lg font-bold text-gray-900 mb-2">Connecting to Server...</h4>
                        <p class="text-gray-500 text-sm">Establishing secure connection to database.</p>
                    </div>

                    {{# Step 2: Generating #}}
                    <div id="step-2" class="text-center w-full hidden">
                        <div class="w-20 h-20 bg-orange-100 rounded-2xl flex items-center justify-center mx-auto mb-6 text-orange-500 text-3xl animate-bounce">
                            <i class="fa-solid fa-gear"></i>
                        </div>
                        <h4 class="text-lg font-bold text-gray-900 mb-2">Generating Link...</h4>
                        <div class="w-full bg-gray-200 rounded-full h-4 mb-2 overflow-hidden">
                            <div id="progress-bar" class="bg-orange-500 h-4 rounded-full w-0"></div>
                        </div>
                        <p class="text-gray-500 text-xs mt-2">Unpacking premium features...</p>
                    </div>

                    {{# Step 3: Verification (CPA Locker) #}}
                    <div id="step-3" class="text-center w-full hidden">
                        <div class="w-20 h-20 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6 text-red-500 text-3xl">
                            <i class="fa-solid fa-user-shield"></i>
                        </div>
                        <h4 class="text-2xl font-bold text-gray-900 mb-2">Verification Required</h4>
                        <p class="text-gray-600 mb-6 text-sm">To prevent bot abuse, please complete a short verification step to unlock your download.</p>
                        
                        <button onclick="triggerOffer()" class="w-full btn-pulse bg-orange-500 hover:bg-orange-600 text-white font-bold py-4 px-6 rounded-xl shadow-lg transition transform hover:-translate-y-1 mb-3">
                            Verify Now & Download
                        </button>
                        <p class="text-xs text-gray-400">Takes less than 30 seconds</p>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>